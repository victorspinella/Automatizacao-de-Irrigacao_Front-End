{"version":3,"file":"status-fa64a193.js","sources":["../../../../pages/status.vue"],"sourcesContent":["<template>\r\n  <Header />\r\n  <div class=\"page-container\">\r\n    <div>\r\n      <button class=\"button\" @click=\"listarEstufas\">Listar Estufas</button>\r\n      <button style=\"width: 125px;\" :style=\"{ backgroundColor: attAuto ? 'Green' : 'Red' }\" class=\"button\"\r\n        @click=\"ligaDesligaAuto\">Tempo Real</button>\r\n    </div>\r\n    <br>\r\n    <div class=\"botoesIncluiExclui\">\r\n      <button class=\"button_include\" @click=\"mostrarFormulario\"\r\n        :style=\"{ backgroundColor: botaoIncluirDesabilitado ? 'gray' : '#007BFF', cursor: botaoIncluirDesabilitado ? 'not-allowed' : 'pointer' }\"\r\n        :disabled=\"botaoIncluirDesabilitado\">Incluir Estufa</button>\r\n      <button class=\"button_include\" v-if=\"exibirFormulario\" @click=\"fecharFormulario\">Cancelar</button>\r\n    </div>\r\n\r\n    <form class=\"form-incluirEstufa\" v-if=\"exibirFormulario\" @submit.prevent=\"adicionarEstufa\">\r\n      <label for=\"nome\">Nome: </label>\r\n      <input class=\"inputsForm\" type=\"text\" v-model=\"novaEstufa.nome\" required />\r\n\r\n      <label for=\"localizacao\">Localização: </label>\r\n      <input class=\"inputsForm\" type=\"text\" v-model=\"novaEstufa.localizacao\" required />\r\n\r\n      <label for=\"capacidade\">Capacidade: </label>\r\n      <input class=\"inputsForm\" style=\"width: 75px;\" type=\"number\" @input=verificaCapacidade id=\"capacidadeEstufa\"\r\n        v-model=\"novaEstufa.capacidade\" required />\r\n\r\n      <button class=\"button\" type=\"submit\"\r\n        :style=\"{ backgroundColor: capacidadeInvalida ? 'gray' : '#007BFF', cursor: capacidadeInvalida ? 'not-allowed' : 'pointer' }\"\r\n        :disabled=\"capacidadeInvalida\">Adicionar Estufa</button>\r\n\r\n\r\n    </form>\r\n    <div v-if=\"listaEstufas.length !== 0\" class=\"table-container\">\r\n      <table class=\"custom-table\">\r\n        <thead>\r\n          <tr>\r\n            <th><input type=\"checkbox\"></th>\r\n            <th>ID estufa</th>\r\n            <th>Nome</th>\r\n            <th>Localização</th>\r\n            <th>Capacidade</th>\r\n            <th>Temperatura</th>\r\n            <th>Umidade</th>\r\n            <th>Consumo</th>\r\n            <th>Data Inclusão</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"estufas in listaEstufas\" :key=\"estufas.id\">\r\n            <td><input type=\"checkbox\"></td>\r\n            <td>{{ estufas.id }}</td>\r\n            <td>{{ estufas.nome }}</td>\r\n            <td>{{ estufas.localizacao }}</td>\r\n            <td>{{ estufas.capacidade }}</td>\r\n            <td>{{ estufas.dadosEstufa.temperatura }} Cº</td>\r\n            <td>{{ estufas.dadosEstufa.umidade }}%</td>\r\n            <td>{{ estufas.dadosEstufa.consumo_agua }}L/h</td>\r\n            <td>{{ estufas.dadosEstufa.timestamp }}</td>\r\n            <td><button class=\"button_delete\" @click=\"deletarEstufa(estufas.id)\">Deletar</button></td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    <br>\r\n    <br>\r\n\r\n\r\n\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { api } from '../infra/axios-config'\r\n\r\nconst listaEstufas = ref([])\r\nconst apiUrlEstufas = `http://localhost:4000`;\r\n\r\nconst listarEstufas = async () => {\r\n\r\n\r\n  try {\r\n\r\n    // const response = await axios.get(apiUrlEstufas, { headers: { Authorization: `Bearer ${token}` } })\r\n    const response = await api.get(`${apiUrlEstufas}/estufas`)\r\n    console.log(response)\r\n\r\n    listaEstufas.value = response.data;\r\n\r\n\r\n  } catch (error) {\r\n    if (error.response.status === 401) {\r\n      window.alert('Usuário não autenticado')\r\n    }\r\n    console.error('Erro ao buscar dados:', error);\r\n  }\r\n}\r\n\r\n\r\n\r\nconst deletarEstufa = async (id) => {\r\n  try {\r\n\r\n    const response = await api.delete(`${apiUrlEstufas}/deleteestufa/${id}`)\r\n    listarEstufas()\r\n    console.log(response)\r\n    window.alert(\"Estufa Excluída\")\r\n  } catch (error) {\r\n    if (error.response.status === 401) {\r\n      window.alert('Usuário não autenticado')\r\n    }\r\n    window.alert(\"Erro ao excluir estufa\")\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst exibirFormulario = ref(false);\r\nconst novaEstufa = ref({\r\n  nome: '',\r\n  localizacao: '',\r\n  capacidade: 0,\r\n});\r\n\r\nconst capacidadeInvalida = ref(true);\r\nconst verificaCapacidade = () => {\r\n  if (document.getElementById('capacidadeEstufa').value <= '0') {\r\n    capacidadeInvalida.value = true;\r\n  } else {\r\n    capacidadeInvalida.value = false;\r\n  }\r\n\r\n}\r\n\r\n\r\nconst adicionarEstufa = async () => {\r\n\r\n  botaoIncluirDesabilitado.value = true;\r\n\r\n\r\n  try {\r\n    // Lógica para adicionar estufa à lista\r\n    const response = await api.post(`${apiUrlEstufas}/addestufa`, novaEstufa.value);\r\n\r\n    // Verifique a resposta da API conforme necessário\r\n    if (response.status === 200) {\r\n      // Adiciona a estufa à lista local\r\n      listaEstufas.value.push({\r\n        id: response.data.id,\r\n        ...novaEstufa.value,\r\n        dadosEstufa: {\r\n          temperatura: 0,\r\n          umidade: 0,\r\n          consumo_agua: 0,\r\n          timestamp: new Date().toLocaleString(),\r\n        },\r\n      });\r\n\r\n      exibirFormulario.value = false;\r\n      capacidadeInvalida.value = false;\r\n    }\r\n    window.alert(\"Estufa adicionada\")\r\n    listarEstufas()\r\n  } catch (error) {\r\n    if (error.response.status === 401) {\r\n      window.alert('Usuário não autenticado')\r\n    }\r\n    console.error('Erro na requisição:', error);\r\n    window.alert(\"Erro ao adicionar estufa\")\r\n  } finally {\r\n    // Reabilita o botão após a adição ou erro\r\n    botaoIncluirDesabilitado.value = false;\r\n    exibirFormulario.value = false;\r\n    novaEstufa.value = {\r\n      nome: '',\r\n      localizacao: '',\r\n      capacidade: 0,\r\n      // Limpe mais campos conforme necessário\r\n    };\r\n  }\r\n};\r\n\r\nlet attAuto = ref()\r\nattAuto.value = false\r\nlet myInterval\r\n\r\nconst ligaDesligaAuto = () => {\r\n  if (!localStorage.getItem('token')) {\r\n    window.alert('Usuário não autenticado')\r\n    return\r\n  }\r\n  attAuto.value = !attAuto.value\r\n  if (attAuto.value == true) {\r\n    atualizarAuto()\r\n    myInterval = setInterval(atualizarAuto, 10000);\r\n  } else {\r\n    clearInterval(myInterval)\r\n    console.log('Att Auto Desligada')\r\n  }\r\n\r\n}\r\n\r\nconst atualizarAuto = () => {\r\n  if (attAuto.value == true) {\r\n    listarEstufas()\r\n    console.log(\"Atualizado\")\r\n  } else {\r\n    console.log(attAuto.value + ' - ELSE')\r\n  }\r\n}\r\n\r\n\r\nlet botaoIncluirDesabilitado = ref(false);\r\nconst mostrarFormulario = () => {\r\n  if (!localStorage.getItem('token')) {\r\n    window.alert('Usuário não autenticado')\r\n    return\r\n  }\r\n  exibirFormulario.value = true;\r\n  botaoIncluirDesabilitado = ref(true);\r\n};\r\n\r\nconst fecharFormulario = () => {\r\n  exibirFormulario.value = false;\r\n  botaoIncluirDesabilitado = ref(false);\r\n  listarEstufas()\r\n}\r\n\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100vh;\r\n  flex-direction: column;\r\n}\r\n\r\n.botoesIncluiExclui {\r\n  width: 100%;\r\n  align-items: center;\r\n  justify-content: center;\r\n  display: flex;\r\n}\r\n\r\n.form-incluirEstufa {\r\n  border: 2px solid black;\r\n  padding: 10px;\r\n  border-radius: 5px;\r\n}\r\n\r\n.inputsForm {\r\n  margin-right: 10px;\r\n  border-bottom: 2px solid black;\r\n}\r\n\r\n.button-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.button {\r\n  margin: 10px;\r\n  padding: 10px 20px;\r\n  background-color: #007BFF;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n  width: 170px;\r\n}\r\n\r\n.button_delete {\r\n  margin: 10px;\r\n  padding: 10px 20px;\r\n  background-color: #007BFF;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n  width: 75%;\r\n}\r\n\r\n.button_include {\r\n  margin: 10px;\r\n  padding: 10px 20px;\r\n  background-color: #007BFF;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n  width: 10%;\r\n}\r\n\r\n.button_include:hover {\r\n  background-color: #75aae2;\r\n}\r\n\r\n.button_delete:hover {\r\n  background-color: #75aae2;\r\n}\r\n\r\n\r\n.button:hover {\r\n  background-color: #75aae2;\r\n}\r\n\r\n.manual-buttons {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.manual-buttons button {\r\n  margin: 5px;\r\n  padding: 10px 20px;\r\n  background-color: #007BFF;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s ease;\r\n  width: 100px;\r\n}\r\n\r\n.manual-buttons button:hover {\r\n  background-color: #75aae2;\r\n}\r\n\r\n.table-container {\r\n  width: 80%;\r\n  margin-top: 20px;\r\n  overflow-y: auto;\r\n  /* Adiciona a barra de rolagem vertical */\r\n}\r\n\r\n.custom-table {\r\n  width: 100%;\r\n  /* Ajustado para 100% para preencher o contêiner */\r\n  border-collapse: collapse;\r\n}\r\n\r\n.custom-table th,\r\n.custom-table td {\r\n  border: 1px solid #ddd;\r\n  padding: 8px;\r\n  text-align: center;\r\n}\r\n\r\n.custom-table th {\r\n  background-color: #f2f2f2;\r\n  font-weight: bold;\r\n}\r\n</style>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AA8EA,UAAM,eAAe,IAAI,EAAE;AAyC3B,UAAM,mBAAmB,IAAI,KAAK;AAClC,UAAM,aAAa,IAAI;AAAA,MACrB,MAAM;AAAA,MACN,aAAa;AAAA,MACb,YAAY;AAAA,IACd,CAAC;AAED,UAAM,qBAAqB,IAAI,IAAI;AA0DnC,QAAI,UAAU,IAAK;AACnB,YAAQ,QAAQ;AA6BhB,QAAI,2BAA2B,IAAI,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}