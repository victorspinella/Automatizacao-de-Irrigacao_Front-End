import{a as _,_ as E}from"./axios-config.7911fab8.js";import{_ as x,r as g,c as i,b as S,a,x as h,y as $,t as l,F as f,z,A as B,o as u,B as y,p as U,e as D}from"./entry.acdcd3de.js";import"./axios.3a76d256.js";const w=r=>(U("data-v-c44c623e"),r=r(),D(),r),V={class:"page-container"},L=w(()=>a("br",null,null,-1)),N={key:0,class:"table-container"},R={class:"custom-table"},F=w(()=>a("thead",null,[a("tr",null,[a("th",null,"Estufa"),a("th",null,"Bomba"),a("th",null,"Válvula")])],-1)),G=["onClick"],v="http://localhost:4000",H="",P={__name:"controle",setup(r){const C=t=>{const e=c.value.find(b=>b.id===t),d=e.comando_bomba,o=e.comando_valvula;d&&o?k(t):I(t),n()},I=async t=>{try{const e=await _.put(`${v}/ligar/controles/${t}`)}catch(e){console.error("Erro ao ligar:",e),e.response.status===401&&window.alert("Usuário não autenticado")}n()},k=async t=>{try{const e=await _.put(`${v}/desligar/controles/${t}`)}catch(e){console.error("Erro ao desligar:",e),e.response.status===401&&window.alert("Usuário não autenticado")}n()},c=g([]),n=async()=>{try{const t=await _.get(`${v}/controlesIrrigacao`);c.value=t.data}catch(t){console.error("Erro ao buscar dados:",t),t.response.status===401&&window.alert("Usuário não autenticado")}};let s=g();s.value=!1;let m;const A=()=>{if(!localStorage.getItem("token")){window.alert("Usuário não autenticado");return}s.value=!s.value,s.value==!0?(p(),m=setInterval(p,1e4)):(clearInterval(m),console.log("Att Auto Desligada"))},p=()=>{s.value==!0?(n(),console.log("Atualizado")):console.log(s.value+" - ELSE")};return(t,e)=>{const d=E;return u(),i(f,null,[S(d),a("div",V,[a("div",null,[a("button",{class:"button",onClick:n},"Listar Controles"),a("button",{style:h([{width:"125px"},{backgroundColor:$(s)?"Green":"Red"}]),class:"button",onClick:A},"Tempo Real",4)]),L,a("div",null,l(H)),c.value.length!==0?(u(),i("div",N,[a("table",R,[F,a("tbody",null,[(u(!0),i(f,null,z(c.value,o=>(u(),i("tr",{key:o.id},[a("td",null,l(o.estufa_id),1),a("td",{class:y({ativo:o.comando_bomba,inativo:!o.comando_bomba})},l(o.comando_bomba?"Ativa":"Inativa"),3),a("td",{class:y({ativo:o.comando_valvula,inativo:!o.comando_valvula})},l(o.comando_valvula?"Ativa":"Inativa"),3),a("td",null,[a("button",{class:"button",onClick:b=>C(o.id),style:h({backgroundColor:o.comando_bomba&&o.comando_valvula?"Green":"Red"})},l(o.comando_bomba&&o.comando_valvula?"Ativo":"Inativo"),13,G)])]))),128))])])])):B("",!0)])],64)}}},J=x(P,[["__scopeId","data-v-c44c623e"]]);export{J as default};
